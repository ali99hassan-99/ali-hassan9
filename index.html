<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>علي حسن للبرمجيات</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</head>
<body>
    <div class="news-ticker">
        <p id="news-content"> عن أمير المؤمنين عليه السلام: "تنافسوا في المعروف لإخوانكم وكونوا من أهله..."</p>
    </div>

    <header>
        <h1>علي حسن للبرمجيات</h1>
    </header>

    <section class="profile">
        <img src="a1.jpg" alt="صورتك" class="profile-img">
        <h2>مرحبًا بك في مدونتي علي حسن للبرمجيات</h2>
        <p>نحن نقدم حلولاً برمجية مبتكرة تساعد في تطوير أعمالك وتقنياتك.</p>
    </section>

    <section class="search-bar">
        <p>للبحث عن مقابلتك، اكتب اسمك الرباعي واضغط "بحث"</p>
        <input type="text" id="search" placeholder="ابحث هنا..." />
        <button onclick="searchFunction()">بحث</button>
        <p id="search-result"></p>
    </section>

    <div class="footer-space"></div>

    <footer>
        <p>يمكنك التواصل معي على:</p>
        <ul>
            <li><a href="https://www.facebook.com/profile.php?id=100079286824119&mibextid=ZbWKwL" class="facebook">فيسبوك</a></li>
            <li><a href="https://t.me/a9_9h9" class="telegram">تليجرام</a></li>
            <li><a href="https://wa.me/9647822621995" class="whatsapp">واتساب</a></li>
        </ul>
        <p>جميع الحقوق محفوظة للمطور علي حسن</p>
    </footer>

    <script>
        let sheetData = [];

        // تحميل ملف Excel من الرابط وتحويله إلى مصفوفة
        function loadExcelFile(url) {
            fetch(url)
                .then(response => response.arrayBuffer())
                .then(data => {
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheet = workbook.Sheets[workbook.SheetNames[0]];
                    sheetData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
                    console.log('Data loaded:', sheetData); // تحقق من تحميل البيانات
                })
                .catch(error => console.error('Error loading the file:', error));
        }

        // تحميل الملف عند تحميل الصفحة
        window.onload = function() {
            const url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRVV8V3W5SPPRd7c4X4hy9PSMhuxhRGBdi4eFGwua4xNQmCJatGEM2dsT_j-Mq6wA/pub?output=xlsx';
            loadExcelFile(url);
        };

        // دالة البحث
        function searchFunction() {
            const searchTerm = document.getElementById('search').value.trim().toLowerCase();
            const result = document.getElementById('search-result');
            if (!searchTerm) {
                result.innerText = 'يرجى إدخال اسم للبحث.';
                return;
            }

            // البحث في البيانات
            const found = sheetData.find(row => row[0] && row[0].toLowerCase().includes(searchTerm));
            if (found) {
                result.innerText = `الأسم: ${found[0]}, قابلت في: ${found[1] || 'غير متوفرة'}`;
            } else {
                result.innerText = 'لم يتم العثور على البيانات.';
            }
        }
    </script>
</body>
</html>
